(function(a){a.jScrollPaneCusel={active:[]};a.fn.jScrollPaneCusel=function(b){b=a.extend({},a.fn.jScrollPaneCusel.defaults,b);var l=function(){return!1};return this.each(function(){var c=a(this),f=this.parentNode.offsetWidth;c.css("overflow","hidden");var M=this;if(a(this).parent().is(".jScrollPaneContainer")){var N=b.maintainPosition?c.position().top:0,d=a(this).parent(),g=d.outerHeight(),p=g;a(">.jScrollPaneTrack, >.jScrollArrowUp, >.jScrollArrowDown",d).remove();c.css({top:0})}else N=0,this.originalPadding=
c.css("paddingTop")+" "+c.css("paddingRight")+" "+c.css("paddingBottom")+" "+c.css("paddingLeft"),this.originalSidePaddingTotal=(parseInt(c.css("paddingLeft"))||0)+(parseInt(c.css("paddingRight"))||0),p=g=c.innerHeight(),c.wrap("<div class='jScrollPaneContainer'></div>").parent().css({height:g+"px",width:f+"px"}),window.navigator.userProfile||(d=parseInt(a(this).parent().css("border-left-width"))+parseInt(a(this).parent().css("border-right-width")),f-=d,a(this).css("width",f+"px").parent().css("width",
f+"px")),a(document).bind("emchange",function(a,t,g){c.jScrollPaneCusel(b)});if(b.reinitialiseOnImageLoad){var u=a.data(M,"jScrollPaneImagesToLoad")||a("img",c),O=[];u.length&&u.each(function(e,t){a(this).bind("load",function(){-1==a.inArray(e,O)&&(O.push(t),u=a.grep(u,function(a,e){return a!=t}),a.data(M,"jScrollPaneImagesToLoad",u),b.reinitialiseOnImageLoad=!1,c.jScrollPaneCusel(b))}).each(function(a,e){if(this.complete||void 0===this.complete)this.src=this.src})})}d={height:"auto",width:f-b.scrollbarWidth-
b.scrollbarMargin-this.originalSidePaddingTotal+"px"};b.scrollbarOnLeft?d.paddingLeft=b.scrollbarMargin+b.scrollbarWidth+"px":d.paddingRight=b.scrollbarMargin+"px";c.css(d);var v=c.outerHeight(),w=g/v;if(.99>w){var ba=function(){var a=(x-h)/b.animateStep;1<a||-1>a?m(h+a):(m(x),y())},k=c.parent();k.append(a('<div class="jScrollPaneTrack"></div>').css({width:b.scrollbarWidth+"px"}).append(a('<div class="jScrollPaneDrag"></div>').css({width:b.scrollbarWidth+"px"}).append(a('<div class="jScrollPaneDragTop"></div>').css({width:b.scrollbarWidth+
"px"}),a('<div class="jScrollPaneDragBottom"></div>').css({width:b.scrollbarWidth+"px"}))));var f=a(">.jScrollPaneTrack",k),z=a(">.jScrollPaneTrack .jScrollPaneDrag",k);if(b.showArrows){var A,G,P,B,Q=function(){(4<B||0==B%4)&&m(h+G*H);B++},R=function(e){a("html").unbind("mouseup",R);A.removeClass("jScrollActiveArrowButton");clearInterval(P)},S=function(){a("html").bind("mouseup",R);A.addClass("jScrollActiveArrowButton");B=0;Q();P=setInterval(Q,100)};k.append(a("<div></div>").attr({"class":"jScrollArrowUp"}).css({width:b.scrollbarWidth+
"px"}).bind("mousedown",function(){A=a(this);G=-1;S();this.blur();return!1}).bind("click",l),a("<div></div>").attr({"class":"jScrollArrowDown"}).css({width:b.scrollbarWidth+"px"}).bind("mousedown",function(){A=a(this);G=1;S();this.blur();return!1}).bind("click",l));var T=a(">.jScrollArrowUp",k),U=a(">.jScrollArrowDown",k);b.arrowSize?(p=g-b.arrowSize-b.arrowSize,f.css({height:p+"px",top:b.arrowSize+"px"})):(d=T.height(),b.arrowSize=d,p=g-d-U.height(),f.css({height:p+"px",top:d+"px"}))}var I=a(this).css({position:"absolute",
overflow:"visible"}),q,n,H,h=0,C=w*g/2,J=function(a,b){var e="X"==b?"Left":"Top";return a["page"+b]||a["client"+b]+(document.documentElement["scroll"+e]||document.body["scroll"+e])||0},D=function(){return!1},E=function(){y();q=z.offset(!1);q.top-=h;n=p-z[0].offsetHeight;H=2*b.wheelSpeed*n/v},V=function(){a("html").unbind("mouseup",V).unbind("mousemove",W);C=w*g/2;a.browser.msie&&a("html").unbind("dragstart",D).unbind("selectstart",D)},m=function(a){h=a=0>a?0:a>n?n:a;z.css({top:a+"px"});I.css({top:a/
n*(g-v)+"px"});c.trigger("scroll");b.showArrows&&(T[0==a?"addClass":"removeClass"]("disabled"),U[a==n?"addClass":"removeClass"]("disabled"))},W=function(a){m(J(a,"Y")-q.top-C)};z.css({height:Math.max(Math.min(w*(g-2*b.arrowSize),b.dragMaxHeight),b.dragMinHeight)+"px"}).bind("mousedown",function(b){E();C=J(b,"Y")-h-q.top;a("html").bind("mouseup",V).bind("mousemove",W);a.browser.msie&&a("html").bind("dragstart",D).bind("selectstart",D);return!1});var X,F,Y,Z=function(){(8<F||0==F%4)&&m(h-(h-Y)/2);F++},
aa=function(){clearInterval(X);a("html").unbind("mouseup",aa).unbind("mousemove",K)},K=function(a){Y=J(a,"Y")-q.top-C};f.bind("mousedown",function(b){E();K(b);F=0;a("html").bind("mouseup",aa).bind("mousemove",K);X=setInterval(Z,100);Z()});k.bind("mousewheel",function(a,b){E();y();m(h-b*H);return!1});var x,L,y=function(){L&&(clearInterval(L),delete x)},r=function(e,t){if("string"==typeof e){$e=a(e,c);if(!$e.length)return;e=$e.offset().top-c.offset().top}k.scrollTop(0);y();var d=-e/(g-v)*n;t||!b.animateTo?
m(d):(x=d,L=setInterval(ba,b.animateInterval))};c[0].scrollTo=r;c[0].scrollBy=function(a){var b=-parseInt(I.css("top"))||0;r(b+a)};E();r(-N,!0);a("*",this).bind("focus",function(e){var d=a(this);for(e=0;d[0]!=c[0];)e+=d.position().top,d=d.offsetParent();var d=-parseInt(I.css("top"))||0,f=d+g;e>d&&e<f||(f=e-b.scrollbarMargin,e>d&&(f+=a(this).height()+15+b.scrollbarMargin-g),r(f))});location.hash&&r(location.hash);a(document).bind("click",function(b){$target=a(b.target);$target.is("a")&&(b=$target.attr("href"),
"#"==b.substr(0,1)&&r(b))});a.jScrollPaneCusel.active.push(c[0])}else c.css({height:g+"px",width:f-this.originalSidePaddingTotal+"px",padding:this.originalPadding}),c.parent().unbind("mousewheel")})};a.fn.jScrollPaneRemoveCusel=function(){a(this).each(function(){$this=a(this);var b=$this.parent();b.is(".jScrollPaneContainer")&&($this.css({top:"",height:"",width:"",padding:"",overflow:"",position:""}),$this.attr("style",$this.data("originalStyleTag")),b.after($this).remove())})};a.fn.jScrollPaneCusel.defaults=
{scrollbarWidth:10,scrollbarMargin:5,wheelSpeed:18,showArrows:!1,arrowSize:0,animateTo:!1,dragMinHeight:1,dragMaxHeight:99999,animateInterval:100,animateStep:3,maintainPosition:!0,scrollbarOnLeft:!1,reinitialiseOnImageLoad:!1};a(window).bind("unload",function(){for(var b=a.jScrollPaneCusel.active,l=0;l<b.length;l++)b[l].scrollTo=b[l].scrollBy=null})})(jQuery);